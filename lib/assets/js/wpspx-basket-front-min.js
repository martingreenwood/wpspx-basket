!function(t){"use strict";function e(t,e){if(this.createTextRange){var a=this.createTextRange();a.collapse(!0),a.moveStart("character",t),a.moveEnd("character",e-t),a.select()}else this.setSelectionRange&&(this.focus(),this.setSelectionRange(t,e))}function a(t){var e=this.value.length;if(t="start"==t.toLowerCase()?"Start":"End",document.selection){var a,i,s,n=document.selection.createRange();return(a=n.duplicate()).expand("textedit"),a.setEndPoint("EndToEnd",n),s=(i=a.text.length-n.text.length)+n.text.length,"Start"==t?i:s}return void 0!==this["selection"+t]&&(e=this["selection"+t]),e}var i={codes:{46:127,188:44,109:45,190:46,191:47,192:96,220:92,222:39,221:93,219:91,173:45,187:61,186:59,189:45,110:46},shifts:{96:"~",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",48:")",45:"_",61:"+",91:"{",93:"}",92:"|",59:":",39:'"',44:"<",46:">",47:"?"}};t.fn.number=function(s,n,l,d){d=void 0===d?",":d,n=void 0===n?0:n;var o="\\u"+("0000"+(l=void 0===l?".":l).charCodeAt(0).toString(16)).slice(-4),r=new RegExp("[^"+o+"0-9]","g"),c=new RegExp(o,"g");return!0===s?this.is("input:text")?this.on({"keydown.format":function(s){var o=t(this),r=o.data("numFormat"),c=s.keyCode?s.keyCode:s.which,p="",u=a.apply(this,["start"]),v=a.apply(this,["end"]),h="",m=!1;if(i.codes.hasOwnProperty(c)&&(c=i.codes[c]),!s.shiftKey&&c>=65&&90>=c?c+=32:!s.shiftKey&&c>=69&&105>=c?c-=48:s.shiftKey&&i.shifts.hasOwnProperty(c)&&(p=i.shifts[c]),""==p&&(p=String.fromCharCode(c)),8!=c&&45!=c&&127!=c&&p!=l&&!p.match(/[0-9]/)){var f=s.keyCode?s.keyCode:s.which;if(46==f||8==f||127==f||9==f||27==f||13==f||(65==f||82==f||80==f||83==f||70==f||72==f||66==f||74==f||84==f||90==f||61==f||173==f||48==f)&&!0===(s.ctrlKey||s.metaKey)||(86==f||67==f||88==f)&&!0===(s.ctrlKey||s.metaKey)||f>=35&&39>=f||f>=112&&123>=f)return;return s.preventDefault(),!1}if(0==u&&v==this.value.length?8==c?(u=v=1,this.value="",r.init=n>0?-1:0,r.c=n>0?-(n+1):0,e.apply(this,[0,0])):p==l?(u=v=1,this.value="0"+l+new Array(n+1).join("0"),r.init=n>0?1:0,r.c=n>0?-(n+1):0):45==c?(u=v=2,this.value="-0"+l+new Array(n+1).join("0"),r.init=n>0?1:0,r.c=n>0?-(n+1):0,e.apply(this,[2,2])):(r.init=n>0?-1:0,r.c=n>0?-n:0):r.c=v-this.value.length,r.isPartialSelection=u!=v,n>0&&p==l&&u==this.value.length-n-1)r.c++,r.init=Math.max(0,r.init),s.preventDefault(),m=this.value.length+r.c;else if(45!=c||0==u&&0!=this.value.indexOf("-"))if(p==l)r.init=Math.max(0,r.init),s.preventDefault();else if(n>0&&127==c&&u==this.value.length-n-1)s.preventDefault();else if(n>0&&8==c&&u==this.value.length-n)s.preventDefault(),r.c--,m=this.value.length+r.c;else if(n>0&&127==c&&u>this.value.length-n-1){if(""===this.value)return;"0"!=this.value.slice(u,u+1)&&(h=this.value.slice(0,u)+"0"+this.value.slice(u+1),o.val(h)),s.preventDefault(),m=this.value.length+r.c}else if(n>0&&8==c&&u>this.value.length-n){if(""===this.value)return;"0"!=this.value.slice(u-1,u)&&(h=this.value.slice(0,u-1)+"0"+this.value.slice(u),o.val(h)),s.preventDefault(),r.c--,m=this.value.length+r.c}else 127==c&&this.value.slice(u,u+1)==d?s.preventDefault():8==c&&this.value.slice(u-1,u)==d?(s.preventDefault(),r.c--,m=this.value.length+r.c):n>0&&u==v&&this.value.length>n+1&&u>this.value.length-n-1&&isFinite(+p)&&!s.metaKey&&!s.ctrlKey&&!s.altKey&&1===p.length&&(h=v===this.value.length?this.value.slice(0,u-1):this.value.slice(0,u)+this.value.slice(u+1),this.value=h,m=u);else s.preventDefault();!1!==m&&e.apply(this,[m,m]),o.data("numFormat",r)},"keyup.format":function(i){var s,l=t(this),d=l.data("numFormat"),o=i.keyCode?i.keyCode:i.which,r=a.apply(this,["start"]),c=a.apply(this,["end"]);0!==r||0!==c||189!==o&&109!==o||(l.val("-"+l.val()),r=1,d.c=1-this.value.length,d.init=1,l.data("numFormat",d),s=this.value.length+d.c,e.apply(this,[s,s])),""===this.value||(48>o||o>57)&&(96>o||o>105)&&8!==o&&46!==o&&110!==o||(l.val(l.val()),n>0&&(d.init<1?(r=this.value.length-n-(d.init<0?1:0),d.c=r-this.value.length,d.init=1,l.data("numFormat",d)):r>this.value.length-n&&8!=o&&(d.c++,l.data("numFormat",d))),46!=o||d.isPartialSelection||(d.c++,l.data("numFormat",d)),s=this.value.length+d.c,e.apply(this,[s,s]))},"paste.format":function(e){var a=t(this),i=e.originalEvent,s=null;return window.clipboardData&&window.clipboardData.getData?s=window.clipboardData.getData("Text"):i.clipboardData&&i.clipboardData.getData&&(s=i.clipboardData.getData("text/plain")),a.val(s),e.preventDefault(),!1}}).each((function(){var e=t(this).data("numFormat",{c:-(n+1),decimals:n,thousands_sep:d,dec_point:l,regex_dec_num:r,regex_dec:c,init:!!this.value.indexOf(".")});""!==this.value&&e.val(e.val())})):this.each((function(){var e=t(this),a=+e.text().replace(r,"").replace(c,".");e.number(isFinite(a)?+a:0,n,l,d)})):this.text(t.number.apply(window,arguments))};var s=null,n=null;t.isPlainObject(t.valHooks.text)?(t.isFunction(t.valHooks.text.get)&&(s=t.valHooks.text.get),t.isFunction(t.valHooks.text.set)&&(n=t.valHooks.text.set)):t.valHooks.text={},t.valHooks.text.get=function(e){var a,i=t(e).data("numFormat");return i?""===e.value?"":(a=+e.value.replace(i.regex_dec_num,"").replace(i.regex_dec,"."),(0===e.value.indexOf("-")?"-":"")+(isFinite(a)?a:0)):t.isFunction(s)?s(e):void 0},t.valHooks.text.set=function(e,a){var i=t(e).data("numFormat");if(i){var s=t.number(a,i.decimals,i.dec_point,i.thousands_sep);return t.isFunction(n)?n(e,s):e.value=s}return t.isFunction(n)?n(e,a):void 0},t.number=function(t,e,a,i){i=void 0===i?"1000"!==new Number(1e3).toLocaleString()?new Number(1e3).toLocaleString().charAt(1):"":i,a=void 0===a?new Number(.1).toLocaleString().charAt(1):a,e=isFinite(+e)?Math.abs(e):0;var s="\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4),n="\\u"+("0000"+i.charCodeAt(0).toString(16)).slice(-4);t=(t+"").replace(".",a).replace(new RegExp(n,"g"),"").replace(new RegExp(s,"g"),".").replace(new RegExp("[^0-9+-Ee.]","g"),"");var l=isFinite(+t)?+t:0,d="";return(d=(e?function(t,e){return""+ +(Math.round((""+t).indexOf("e")>0?t:t+"e+"+e)+"e-"+e)}(l,e):""+Math.round(l)).split("."))[0].length>3&&(d[0]=d[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(d[1]||"").length<e&&(d[1]=d[1]||"",d[1]+=new Array(e-d[1].length+1).join("0")),d.join(a)}}(jQuery),jQuery(document).ready((function(t){t.date=function(t){var e=new Date(t),a=e.getDate(),i=e.getMonth()+1;return a<10&&(a="0"+a),i<10&&(i="0"+i),a+"/"+i+"/"+e.getFullYear()};var e,a,i=t(".cache_url").attr("data-cache-url");setTimeout((function(){t(".wpspxbasket").addClass("shown")}),2e3),t(".wpspxbasket").on("click",(function(e){t(".wpspxbasket-side-panel").addClass("show")})),t(".wpspx-basket-close").on("click",(function(e){e.preventDefault(),t(".wpspxbasket-side-panel").removeClass("show")})),t.getJSON(i+"memberships.json",(function(t){e=t})),t.getJSON(i+"events.json",(function(t){a=t})),t(".wpspxbasket").on("click",(function(){var i=new Array,s=jQuery.parseJSON(localStorage.getItem("spektrixBasket")),n=jQuery.parseJSON(localStorage.getItem("spektrixClientConstants")),l=n.data.apiEndpoint,d=(n.data.clientName,n.data.currencyChar),o=n.data.currencyDecimalPlaces;n.data.enabled,n.data.loginUrl,n.data.spektrixHost,n.data.timeoutMinutes,n.timestamp.timeoutMinutes,n.timestamp.transactionCommission;console.log(s);var r=s.data.total,c=s.data.totalDiscount,p=(s.data.id,s.data.customer,s.data.transactionCommission.amount),u=s.data.transactionCommission.waived,v=s.data.donations;t.each(v,(function(e,a){i.push('<div class="wpspx-basket-item"><div class="wpspx-remove" data-id="'+a.id+'" data-type="donations"><a href="#" class="wpspx-remove-from-basket" aria-label="Remove this item" data-product_id="139"><i class="far fa-times"></i></a></div><div class="wpspx-item-info"><div class="wpspx-title"><span>Donation</span></div><div class="amount"><span class="wpspx-price-symbol">'+d+t.number(a.amount,o)+"</span></div></div></div>")}));var h=s.data.giftVouchers;new Array;t.each(h,(function(e,a){var s=t.date(a.sendDate);i.push('<div class="wpspx-basket-item"><div class="wpspx-remove" data-id="'+a.id+'" data-type="gift-vouchers"><a href="#" class="wpspx-remove-from-basket" aria-label="Remove this item" data-product_id="139"><i class="far fa-times"></i></a></div><div class="wpspx-item-info"><div class="wpspx-title"><span>Gift Voucher</span></div><div class="amount"><span class="wpspx-price-symbol">'+d+t.number(a.amount,o)+'</span></div><div class="view-additional-details"><i class="far fa-info-circle"></i></div><div class="additional-details"><dl><dt>From:</dt><dd>'+a.fromName+"</dd><dt>To:</dt><dd>"+a.toName+"</dd><dt>Message:</dt><dd>"+a.message+"</dd><dt>Date to send:</dt><dd>"+s+"</dd></dl></div></div></div>")}));var m=s.data.membershipSubscriptions,f=m.map(t=>({basketID:t.id,...t,...e.find(({id:e})=>e===t.membership.id)})).map((function(t,e){return{membership:t,donation:v[e]}}));t.each(f,(function(e,a){var s=a.membership.total,n=(a.membership.price,a.membership.discount);if(a.donation)var l=a.donation.amount;else l=0;var r=s+n+l,c=t.date(a.membership.startDate),p=t.date(a.membership.expiryDate);i.push('<div class="wpspx-basket-item"><div class="wpspx-remove" data-id="'+a.membership.basketID+'" data-type="membership-subscriptions"><a href="#" class="wpspx-remove-from-basket" aria-label="Remove this item" data-product_id="139"><i class="far fa-times"></i></a></div><div class="wpspx-item-info"><div class="wpspx-title"><span>'+a.membership.name+'</span></div><div class="amount"><span class="wpspx-price-symbol">'+d+t.number(r,o)+'</span></div><div class="view-additional-details"><i class="far fa-info-circle"></i></div><div class="additional-details"><dl><dt>Starting:</dt><dd>'+c+"</dd><dt>Ending:</dt><dd>"+p+"</dd><dt>Auto renew?:</dt><dd>"+a.membership.autoRenew+"</dd></dl></div></div></div>")}));var g=s.data.merchandiseItems,x=s.data.tickets,w=x.map(t=>({eventID:t.id,...t,...a.find(({id:e})=>e===t.event.id)}));t.each(w,(function(e,a){var s=a.total,n=(a.price,s+a.discount);i.push('<div class="wpspx-basket-item"><div class="wpspx-remove" data-id="'+a.id+'" data-type="tickets"><a href="#" class="wpspx-remove-from-basket" aria-label="Remove this item" data-product_id="139"><i class="far fa-times"></i></a></div><div class="wpspx-item-info"><div class="wpspx-title"><span>'+a.name+'</span></div><div class="amount"><span class="wpspx-price-symbol">'+d+t.number(n,o)+'</span></div><div class="view-additional-details"><i class="far fa-info-circle"></i></div><div class="additional-details"><dl><dt>Seat:</dt><dd>'+a.seatName+"("+a.planName+")</dd></div></div></div>")}));var b=h.length+m.length+g.length+x.length+v.length;t(".wpspx-total-items").html("<span>"+b+" items in your basket</span>"),t(".wpspx-basket-items").html(i),t("#wpspx-basket-total").html('<div class="wpspx-discount" data-waived="'+u+'"><span>Booking Fee</span> <strong>'+d+t.number(p,o)+'</strong></div><div class="wpspx-discount"><span>Discount</span> <strong>'+d+t.number(c,o)+"</strong></div><div><strong>Subtotal</strong> <strong>"+d+t.number(r,o)+"</strong></div>"),t(".view-additional-details").on("click",(function(e){e.preventDefault(),t(this).next().slideToggle()})),t(".wpspx-remove").on("click",(function(e){e.preventDefault();var a=t(this).attr("data-id"),i=t(this).attr("data-type");console.log(a),console.log(i);var s={url:l+"basket/"+i+"/"+a,method:"DELETE"};t.ajax(s).done((function(e){t(this).parent().remove(),b--,t(".wpspx-total-items").html("<span>"+b+" items in your basket</span>")})).fail((function(t,e,a){console.log(t)}))}))}))}));